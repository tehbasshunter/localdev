let nicknames = ["AboutGameplay", "ActionCartridge", "Adventurese", "Alcomnet", "AnimeBuff", "Archwayco", "AssaultAimCorner", "AuraScanner", "Castield", "CoverageCheckpoint", "Daily igra", "DefendWeapon", "Dyarche", "Entimans", "Exposureli", "FeaturedViews", "FootageSmart", "Forwardonyx", "Ghtscore", "HitTelevision", "Infident", "Ivertrag", "MoviesFootage", "Obscessor", "Populist", "Prosemedq", "Setralitype", "SingularNetwork", "Teriantig", "TrackerAbsolute"];
let session = {
    "session": {
        "data": {
            "follower-latest": {
                "name": "StreamElements"
            },
            "follower-week": {
                "count": 1
            },
            "follower-month": {
                "count": 2
            },
            "follower-goal": {
                "amount": 1
            },
            "follower-total": {
                "count": 6
            },
            "subscriber-latest": {
                "name": "test",
                "amount": 1,
                "tier": "1",
                "message": "My test"
            },
            "subscriber-week": {
                "count": 1
            },
            "subscriber-month": {
                "count": 2
            },
            "subscriber-goal": {
                "amount": 1
            },
            "subscriber-total": {
                "count": 4
            },
            "subscriber-points": {
                "amount": 4
            },
            "host-latest": {
                "name": "HostElements",
                "amount": 20
            },
            "raid-latest": {
                "name": "RaidElements",
                "amount": 20
            },
            "cheer-week": {
                "amount": 10
            },
            "cheer-month": {
                "amount": 20
            },
            "cheer-total": {
                "amount": 30
            },
            "cheer-count": {
                "count": 20
            },
            "cheer-goal": {
                "amount": 5000
            },
            "cheer-latest": {
                "name": "Andrew",
                "amount": 200
            },
            "tip-latest": {
                "name": "Test",
                "amount": 5,
                "message": "A fancy test message"
            },
            "tip-monthly-top-donation": {
                "name": "mr_tester",
                "amount": 100
            },
            "tip-alltime-top-donation": {
                "name": "username",
                "amount": 123
            },
            "tip-monthly-top-donator": {
                "name": "mr_tester",
                "amount": 200
            },
            "tip-alltime-top-donator": {
                "name": "mr_tester",
                "amount": 200
            },
            "tip-week": {
                "amount": 5
            },
            "tip-month": {
                "amount": 205
            },
            "tip-total": {
                "amount": 377.99
            },
            "tip-goal": {
                "amount": 5
            },
            "merch-goal-orders": {
                "amount": 0
            },
            "merch-goal-items": {
                "amount": 0
            },
            "merch-goal-total": {
                "amount": 0
            },
            "follower-recent": [{
                "name": "StreamElements",
                "type": "follower"
            }],
            "subscriber-recent": [],
            "raid-recent": [],
            "cheer-recent": [],
            "tip-recent": [{
                "name": "Test",
                "amount": 5,
                "createdAt": "2019-01-11T15:21:08.160Z",
                "type": "tip"
            }],
            "merch-recent": [],
            "subscriber-alltime-gifter": {
                "name": "",
                "amount": 0
            },
            "subscriber-gifted-latest": {
                "name": "",
                "amount": 0,
                "message": ""
            },
            "subscriber-new-latest": {
                "name": "",
                "amount": 0,
                "message": ""
            },
            "subscriber-resub-latest": {
                "name": "",
                "amount": 0,
                "message": ""
            },
            "cheer-alltime-top-donation": {
                "name": "",
                "amount": 0
            },
            "cheer-alltime-top-donator": {
                "name": "",
                "amount": 0
            },
            "cheer-monthly-top-donation": {
                "name": "",
                "amount": 0
            },
            "cheer-monthly-top-donator": {
                "name": "",
                "amount": 0
            },
            "cheer-session": {
                "amount": 0
            },
            "cheer-session-top-donation": {
                "name": "",
                "amount": 0
            },
            "cheer-session-top-donator": {
                "name": "",
                "amount": 0
            },
            "cheer-weekly-top-donation": {
                "name": "",
                "amount": 0
            },
            "cheer-weekly-top-donator": {
                "name": "",
                "amount": 0
            },
            "follower-session": {
                "count": 0
            },
            "subscriber-gifted-session": {
                "count": 0
            },
            "subscriber-new-session": {
                "count": 0
            },
            "subscriber-resub-session": {
                "count": 0
            },
            "subscriber-session": {
                "count": 0
            },
            "tip-count": {
                "count": 6
            },
            "tip-session": {
                "amount": 205
            },
            "tip-session-top-donation": {
                "name": "ter",
                "amount": 200
            },
            "tip-session-top-donator": {
                "name": "Test",
                "amount": 5
            },
            "tip-weekly-top-donation": {
                "name": "Test",
                "amount": 5
            },
            "tip-weekly-top-donator": {
                "name": "Test",
                "amount": 5
            },
            "merch-latest": {
                "amount": 0,
                "items": [],
                "name": ""
            }
        },
        "settings": {
            "autoReset": true,
            "calendar": true
        }
    },
    "recents": [{
        "name": "Test",
        "amount": 5,
        "createdAt": "2019-01-11T15:21:08.160Z",
        "type": "tip"
    }, {
        "name": "Andrew",
        "type": "follower",
        "createdAt": "2019-01-11T12:21:22.360Z",
    }],
    "currency": {
        "code": "GBP",
        "name": "U.S. Dollar",
        "symbol": "Â£"
    },
    "channel": {
        "username": "MyLittleChannel"
    },
    "fieldData": {

    }
};
let events = {
    "follower": {
        "listener": "follower-latest",
        "event": {
            "type": "follower",
            "name": "Gizela",
            "isTest": true,
            "originalEventName": "follower-latest"
        }
    },
    "redemption": {
        "listener": "redemption-latest",
        "event": {
            "item": "SE T-shirt",
            "itemId": "test",
            "name": "Kara",
            "type": "perk"
        }
    },
    "subscriber": {
        "listener": "subscriber-latest",
        "event": {
            "type": "subscriber",
            "name": "Linnie",
            "amount": "",
            "count": 1,
            "isTest": true,
            "tier": "prime",
            "message": "Do not fear a man that spams 1000 memes, instead fear a man that spams a meme 1000 times",
            "originalEventName": "subscriber-latest"
        }
    },
    "raid": {
        "listener": "raid-latest",
        "event": {
            "type": "raid",
            "name": "Benetta",
            "amount": 10,
            "isTest": true,
            "originalEventName": "raid-latest"
        }
    },
    "tip": {
        "listener": "tip-latest",
        "event": {
            "type": "tip",
            "name": "farmer",
            "amount": 10,
            "message": "Howdy, my name is Bill",
            "originalEventName": "tip-latest"
        }
    },
    "cheer": {
        "listener": "cheer-latest",
        "event": {
            "type": "cheer",
            "name": "Revkah",
            "amount": 1000,
            "count": 4,
            "isTest": true,
            "message": "cheer1000 my",
            "originalEventName": "cheer-latest"
        }
    }
};

function emulateNew(type, amount = "random", count = 1) {
    isGift = 0;
    if (amount === "random") {
        amount = Math.floor(Math.random() * 36) + 1;
    }
    if (amount === "gift") {
        amount = 1;
        isGift = 1;
    }
    let name = nicknames[Math.floor(Math.random() * nicknames.length)];
    let details = events[type];
    let timestamp = new Date();
    let recent = {
        "name": name,
        "type": type,
        "createdAt": timestamp.toISOString,
    }
    if (type === "subscriber" && isGift) {
        details.event.isGift = true;
        details.event.count = count;
        details.event.sender = nicknames[Math.floor(Math.random() * nicknames.length)];
        recent.sender = details.event.sender;
    }
    if (type !== "follower" && type !== "redemption") {
        details.event.amount = amount;
        recent.amount = amount;
    }
    if (type === "cheer") {
        details.event.message = "cheer" + amount + " oh my";
    }
    details.event.name = name;
    session.recents.push(recent);
    session.session.data[type + "-recent"].push(recent);
    let sessionIndex = type + "-latest";
    session.session.data[sessionIndex] = details.event;
    emulateSessionUpdate();
    const e = new CustomEvent('onEventReceived', {
        detail: details
    });
    window.dispatchEvent(e);
}

function emulateInit() {

    for (var key in fieldData) {
        if (fieldData.hasOwnProperty(key)) {
            session.fieldData[key] = fieldData[key]["value"];
        }
    }
    
    const loadEvent = new CustomEvent('onWidgetLoad', {
        detail: session
    });
    window.dispatchEvent(loadEvent);
}

function emulateSessionUpdate() {
    const sessionEvent = new CustomEvent('onSessionUpdate', {
        detail: {
            session: session
        }
    });
    window.dispatchEvent(sessionEvent);
}

function setChannelName(channelName) {
    session.channel = channelName;
}